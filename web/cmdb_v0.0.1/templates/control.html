{% extends "layout.html" %}
{% block body %}
  {% if session.logged_in %}
  
<div class="panel panel-primary">
    <div class="panel-heading">Задачи</div>
  <div class="panel-body"> 
    <div class="container-fluid">
<button class="btn btn btn-default" data-toggle="modal" data-target="#addType">
<span class="glyphicon glyphicon-plus"></span> Тип
</button>

<button class="btn btn btn-default" data-toggle="modal" data-target="#addOptions">
  <span class="glyphicon glyphicon-plus"></span> Опции
</button>

    <!-- Modal addType -->
<div class="modal fade" id="addType" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
         			
      	 <div class="container-fluid" >
      	 	<div class="col-lg-6" >
				
				<form id="addtypeform" action="{{ url_for('new_type') }}" method="post">
				    <label> name </label><input type="text" name="name" /> <br>
				</form>
			</div>
			
    	</div> 

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="submit"  class="btn btn-primary" onClick="document.forms['addtypeform'].submit();" >Save changes</button>
      </div>
    </div>
  </div>
</div>
    <!-- Modal addType -->
    
    
    <!-- Modal addOptions -->
    <div class="modal fade" id="addOptions" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
         			
      	 <div class="container-fluid" >
      	 	<div class="col-lg-6" >
				
				<form id="addtypeform" action="{{ url_for('new_option') }}" method="post">
                    <label> Name </label><input type="text" name="name" /> <br>
                    <select id="type_id" name="type_id">
                        <option disabled>Тип</option>
                    </select>
                    <br>
                    <button type="submit" class="btn btn-default">Add option</button>

<script type="text/javascript">
$(function(){
    $.getJSON('http://cmdb.at-consulting.ru:5000/get_list_type/', function(data) {
                
                $.each(data, function(id, name) { 
                    $('#type_id').append('<option value="' + id + '">' + name+ '</option>');
                });
    });
});
</script>

				</form>
			</div>
			
    	</div> 

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="submit"  class="btn btn-primary" onClick="document.forms['addOptions'].submit();" >Save changes</button>
      </div>
    </div>
  </div>
</div>
    <!-- Modal addType -->
    
    </div>
  </div>
</div>



    <table class=entries>
    <th>Типы</th>
    <tr>
    {% for cols_name in type_cols_names %}
        <td><center><b>{{ cols_name }}</b></center></td>
    {% endfor %}
    </tr>
        
    {% for entry in type_cols %}
        <tr>
        {% set k=0 %}

        {% for cell in entry %}

                <td>
                    {{ cell }}
                </td>

        {% endfor %}
        
        {% if session.logged_in %}
        
            <td><a href="/del_type/{{ entry.id }}"><img src="{{ url_for('static', filename='del.png') }}" alt="Del"></a></td>
        {% endif %}

    </tr>
    {% endfor %}
    </table>



    <table class=entries>
    <th>Свойства</th>
    <tr>
    {% for cols_name in option_cols_names %}
        <td><center><b>{{ cols_name }}</b></center></td>
    {% endfor %}
    </tr>
        
    {% for entry in option_cols %}
        <tr>
        {% set k=0 %}

        {% for cell in entry %}

                <td>
                    {{ cell }}
                </td>

        {% endfor %}
        
        {% if session.logged_in %}
        
            <td><a href="/del_option/{{ entry.id }}"><img src="{{ url_for('static', filename='del.png') }}" alt="Del"></a></td>
        {% endif %}

    </tr>
    {% endfor %}
    </table>



</body>
  {% endif %}
{% endblock %}